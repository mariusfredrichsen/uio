"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.extractDatePartsFromDateString = extractDatePartsFromDateString;
var _d2I18n = _interopRequireDefault(require("@dhis2/d2-i18n"));
var _dateStringRegexp = require("./date-string-regexp");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function extractDatePartsFromDateString(dateString, format) {
  const parts = dateString.match(_dateStringRegexp.dateStringRegExp);
  if (!parts) {
    throw new Error(_d2I18n.default.t(`Date string is invalid, received "{{dateString}}"`, {
      dateString
    }));
  }
  let yearStr, monthStr, dayStr, detectedFormat;
  if (parts[1]) {
    // Match for YYYY-MM-DD
    yearStr = parts[1];
    monthStr = parts[3];
    dayStr = parts[5];
    detectedFormat = 'YYYY-MM-DD';
  } else {
    // Match for DD-MM-YYYY
    dayStr = parts[6];
    monthStr = parts[8];
    yearStr = parts[10];
    detectedFormat = 'DD-MM-YYYY';
  }
  if (format && detectedFormat !== format.toUpperCase()) {
    throw new Error(_d2I18n.default.t(`Date string format does not match the specified format. Expected {{format}} but got {{detectedFormat}}.`, {
      format,
      detectedFormat
    }));
  }
  const year = parseInt(yearStr, 10);
  const month = parseInt(monthStr, 10);
  const day = parseInt(dayStr, 10);
  return {
    year,
    month,
    day,
    format: detectedFormat
  };
}