"use strict";

var _cypressCucumberPreprocessor = require("@badeball/cypress-cucumber-preprocessor");
(0, _cypressCucumberPreprocessor.Given)('an OrganisationUnitTree with two levels is rendered', () => {
  cy.visitStory('OrganisationUnitTree', 'Multiple selection');
});
(0, _cypressCucumberPreprocessor.Given)('no unit is selected', () => {
  cy.window().should(win => {
    expect(win.selection).to.eql([]);
  });
});
(0, _cypressCucumberPreprocessor.Given)('the root level unit is opened', () => {
  cy.getOrgUnitByLabel('Org Unit 1').openOrgUnitNode(true);
});
(0, _cypressCucumberPreprocessor.Given)('the first unit on the second level is selected', () => {
  cy.getOrgUnitByLabel('Org Unit 2').toggleOrgUnitNodeSelection(true);
});
(0, _cypressCucumberPreprocessor.Given)('the first unit on the second level unit is opened', () => {
  cy.getOrgUnitByLabel('Org Unit 2').openOrgUnitNode(true);
});
(0, _cypressCucumberPreprocessor.Given)('the second level has two units', () => {
  cy.getOrgUnitByLabel('Org Unit 2').find('[data-test="dhis2-uiwidgets-orgunittree-node-leaves"]').first().children().filter((index, child) => Cypress.$(child).is('[data-test="dhis2-uiwidgets-orgunittree-node"]')).should('have.length', 2);
});
(0, _cypressCucumberPreprocessor.When)('the user selects a unit', () => {
  cy.getOrgUnitByLabel('Org Unit 1').toggleOrgUnitNodeSelection(true);
});
(0, _cypressCucumberPreprocessor.When)('the user selects the first unit on the second level', () => {
  cy.getOrgUnitByLabel('Org Unit 2').toggleOrgUnitNodeSelection(true);
});
(0, _cypressCucumberPreprocessor.When)('the user selects the root level', () => {
  cy.getOrgUnitByLabel('Org Unit 1').toggleOrgUnitNodeSelection(true);
});
(0, _cypressCucumberPreprocessor.When)('the user selects the second unit on the second level', () => {
  cy.getOrgUnitByLabel('Org Unit 3').toggleOrgUnitNodeSelection(true);
});
(0, _cypressCucumberPreprocessor.Then)('a unit is selected', () => {
  cy.window().should(win => {
    expect(win.selection).to.eql(['/A0000000000']);
  });
});
(0, _cypressCucumberPreprocessor.Then)('the unit on the second level is selected', () => {
  cy.window().should(win => {
    expect(win.selection).to.eql(['/A0000000000/A0000000001']);
  });
});
(0, _cypressCucumberPreprocessor.Then)('the unit on the first level is marked as selected intermediately', () => {
  cy.getOrgUnitByLabel('Org Unit 1').find('[data-test="dhis2-uiwidgets-orgunittree-node-label"] [data-test="dhis2-uicore-checkbox"] input').should($input => {
    expect($input[0].indeterminate).to.be.true;
  });
});
(0, _cypressCucumberPreprocessor.Then)('the root unit is marked as selected', () => {
  cy.window().should(win => {
    expect(win.selection.includes('/A0000000000')).to.be.true;
  });
});
(0, _cypressCucumberPreprocessor.Then)('the first unit is selected', () => {
  cy.window().should(win => {
    expect(win.selection.includes('/A0000000000/A0000000001')).to.be.true;
    expect(win.selection).to.have.length(2);
  });
});
(0, _cypressCucumberPreprocessor.Then)('the second unit is selected', () => {
  cy.window().should(win => {
    expect(win.selection.includes('/A0000000000/A0000000002')).to.be.true;
    expect(win.selection).to.have.length(2);
  });
});