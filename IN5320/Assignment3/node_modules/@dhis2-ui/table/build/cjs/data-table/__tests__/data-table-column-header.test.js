"use strict";

var _enzyme = require("enzyme");
var _react = _interopRequireDefault(require("react"));
var _dataTableColumnHeader = require("../data-table-column-header/data-table-column-header.js");
var _filterHandle = require("../data-table-column-header/filter-handle.js");
var _sorter = require("../data-table-column-header/sorter.js");
var _index = require("../table-elements/index.js");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
describe('<DataTableColumnHeader>', () => {
  it('renders children', () => {
    const children = 'children';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, null, children));
    expect(wrapper.containsMatchingElement(children)).toBe(true);
  });
  it('accepts a ref', () => {
    const ref = /*#__PURE__*/_react.default.createRef();
    const wrapper = (0, _enzyme.mount)( /*#__PURE__*/_react.default.createElement("table", null, /*#__PURE__*/_react.default.createElement("thead", null, /*#__PURE__*/_react.default.createElement("tr", null, /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      ref: ref
    })))));
    expect(wrapper.find('th').getDOMNode()).toBe(ref.current);
  });
  it('accepts an align prop', () => {
    const right = 'right';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      align: right
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('align')).toBe(right);
  });
  it('accepts a className prop', () => {
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      className: "test"
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('className')).toBe('test DataTableColumnHeader');
  });
  it('accepts a colSpan prop', () => {
    const colSpan = '3';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      colSpan: colSpan
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('colSpan')).toBe(colSpan);
  });
  it('accepts a dataTest prop', () => {
    const dataTest = 'test';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      dataTest: dataTest
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('dataTest')).toBe(dataTest);
  });
  it('accepts filter, name, showFilter and onFilterIconClick props', () => {
    //
    const name = 'test';
    const fakeEvent = {
      target: 'test',
      value: 'test'
    };
    const onClickOpen = jest.fn();
    const onClickClosed = jest.fn();
    const wrapperOpen = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      name: name,
      onFilterIconClick: onClickOpen,
      filter: /*#__PURE__*/_react.default.createElement("input", null),
      showFilter: true
    }));
    const wrapperClosed = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      name: name,
      onFilterIconClick: onClickClosed,
      filter: /*#__PURE__*/_react.default.createElement("input", null),
      showFilter: false
    }));
    // Showing/hiding the filter
    expect(wrapperOpen.find('input')).toHaveLength(1);
    expect(wrapperClosed.find('input')).toHaveLength(0);

    // Clicking the filter icon on
    wrapperOpen.find(_filterHandle.FilterHandle).dive().find(_index.TableHeaderCellAction).dive().find('button').simulate('click', fakeEvent);
    expect(onClickOpen).toHaveBeenCalledTimes(1);
    expect(onClickOpen).toHaveBeenCalledWith({
      name,
      // toggled
      show: false
    }, fakeEvent);
    wrapperClosed.find(_filterHandle.FilterHandle).dive().find(_index.TableHeaderCellAction).dive().find('button').simulate('click', fakeEvent);
    expect(onClickClosed).toHaveBeenCalledTimes(1);
    expect(onClickClosed).toHaveBeenCalledWith({
      name,
      // toggled
      show: true
    }, fakeEvent);
  });
  it('accepts a fixed prop', () => {
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      fixed: true,
      left: "200px"
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('fixed')).toBe(true);
  });
  it('accepts a large prop', () => {
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      large: true
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('large')).toBe(true);
  });
  it('accepts a left prop', () => {
    const left = '200px';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      left: left
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('left')).toBe(left);
  });
  it('accepts a role prop', () => {
    const role = 'test';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      role: role
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('role')).toBe(role);
  });
  it('accepts a rowSpan prop', () => {
    const rowSpan = '3';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      rowSpan: rowSpan
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('rowSpan')).toBe(rowSpan);
  });
  it('accepts a scope prop', () => {
    const scope = 'row';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      scope: scope
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('scope')).toBe(scope);
  });
  describe('column header sorting', () => {
    it('accepts sortDirection, sortIconTitle, and onSortIconClick props', () => {
      const name = 'test';
      const title = 'Custom title';
      const fakeEvent = {
        target: 'test',
        value: 'test'
      };
      const onClick = jest.fn();
      const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
        name: name,
        onSortIconClick: onClick,
        sortDirection: 'asc',
        sortIconTitle: title
      }));
      const button = wrapper.find(_sorter.Sorter).dive().find(_index.TableHeaderCellAction).dive().find('button');
      button.simulate('click', fakeEvent);
      expect(onClick).toHaveBeenCalledTimes(1);
      expect(onClick).toHaveBeenCalledWith({
        name,
        // next sort direction
        direction: 'desc'
      }, fakeEvent);
      expect(button.prop('title')).toBe(title);
    });
    it('has a default sort icon title', () => {
      const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
        name: 'test',
        onSortIconClick: () => {},
        sortDirection: 'asc'
      }));
      const button = wrapper.find(_sorter.Sorter).dive().find(_index.TableHeaderCellAction).dive().find('button');
      expect(button.prop('title')).toBe('Sort items');
    });
  });
  it('accepts a top prop', () => {
    const top = '200px';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      top: top
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('top')).toBe(top);
  });
  it('accepts a width prop', () => {
    const width = '200px';
    const wrapper = (0, _enzyme.shallow)( /*#__PURE__*/_react.default.createElement(_dataTableColumnHeader.DataTableColumnHeader, {
      width: width
    }));
    expect(wrapper.find(_index.TableHeaderCell).prop('width')).toBe(width);
  });
});