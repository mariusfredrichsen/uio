SELECT sum(precipitation) as total_precipitation, min(timestamp) as week_start, max(timestamp) as week_end
FROM san_francisco#ext_timed_batch(timestamp, 7 days)
HAVING sum(precipitation) >= 3