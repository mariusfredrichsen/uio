SELECT 
  A.timestamp as first_date,
  B.timestamp as second_date,
  A.averageTemperature as temp1,
  B.averageTemperature as temp2,
  B.averageTemperature - A.averageTemperature as temp_difference
FROM pattern [
  A=jfk -> 
  B=jfk(
    B.averageTemperature - A.averageTemperature >= 40 
  )
]#win:ext_timed(A.timestamp, 7 days)
